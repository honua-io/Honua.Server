{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "description": "Performance optimization configuration for Honua.Server",

  "DataAccess": {
    "DefaultCommandTimeoutSeconds": 30,
    "LongRunningQueryTimeoutSeconds": 300,
    "BulkOperationTimeoutSeconds": 600,
    "TransactionTimeoutSeconds": 120,
    "HealthCheckTimeoutSeconds": 5,
    "EnablePoolingMetrics": true,

    "Postgres": {
      "Pooling": true,
      "MinPoolSize": 2,
      "MaxPoolSize": 50,
      "AutoScale": true,
      "ScaleFactor": 15,
      "ConnectionLifetime": 600,
      "Timeout": 15,
      "ApplicationName": "Honua.Server"
    },

    "SqlServer": {
      "Pooling": true,
      "MinPoolSize": 2,
      "MaxPoolSize": 50,
      "ConnectionLifetime": 600,
      "ConnectTimeout": 15,
      "ApplicationName": "Honua.Server"
    },

    "MySql": {
      "Pooling": true,
      "MinimumPoolSize": 2,
      "MaximumPoolSize": 50,
      "ConnectionLifeTime": 600,
      "ConnectionTimeout": 15,
      "ApplicationName": "Honua.Server"
    },

    "Sqlite": {
      "Pooling": true,
      "EnableWalMode": true,
      "DefaultTimeout": 30,
      "CacheMode": "Shared"
    }
  },

  "FeatureQueryCache": {
    "Enabled": true,
    "TtlSeconds": 300,
    "MaxCacheSizeMb": 1024,
    "InvalidateOnWrite": true,
    "EnableMetrics": true,

    "ServiceTtlOverrides": {
      "wfs-static-data": 3600,
      "wfs-reference-layers": 7200,
      "wfs-realtime-sensors": 60
    },

    "LayerTtlOverrides": {
      "wfs-buildings:parcels": 1800,
      "wfs-buildings:zoning": 3600,
      "wfs-sensors:temperature": 30,
      "wfs-sensors:weather": 60
    }
  },

  "QueryPerformanceMonitor": {
    "EnableSlowQueryLogging": true,
    "SlowQueryThresholdMs": 500,
    "EnableQueryPlanAnalysis": false,
    "OffsetWarningThreshold": 1000,
    "EnableMetrics": true
  },

  "Redis": {
    "ConnectionString": "localhost:6379",
    "InstanceName": "honua:",
    "ConnectTimeout": 5000,
    "SyncTimeout": 5000,
    "AbortOnConnectFail": false,
    "ConnectRetry": 3,
    "KeepAlive": 60,
    "DefaultDatabase": 0,
    "Ssl": false,
    "AllowAdmin": false
  },

  "Caching": {
    "Enabled": true,
    "Provider": "Redis",
    "FallbackToMemory": true,

    "Memory": {
      "SizeLimitMb": 512,
      "CompactionPercentage": 0.25,
      "ExpirationScanFrequencySeconds": 60
    },

    "Distributed": {
      "AbsoluteExpirationSeconds": 3600,
      "SlidingExpirationSeconds": 1800
    }
  },

  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft": "Warning",
      "Microsoft.Hosting.Lifetime": "Information",
      "Honua.Server.Core.Data.Postgres": "Information",
      "Honua.Server.Host.Ogc.Services": "Information",
      "Honua.Server.Enterprise.Sensors": "Information"
    },

    "Performance": {
      "LogSlowQueries": true,
      "SlowQueryThresholdMs": 500,
      "LogQueryPlans": false,
      "LogCacheMetrics": true,
      "LogConnectionPoolMetrics": true
    }
  },

  "HealthChecks": {
    "Enabled": true,
    "CheckInterval": 30,

    "Database": {
      "Enabled": true,
      "Timeout": 5,
      "Tags": ["database", "critical"]
    },

    "Redis": {
      "Enabled": true,
      "Timeout": 3,
      "Tags": ["cache", "important"]
    },

    "ConnectionPool": {
      "Enabled": true,
      "WarningThreshold": 0.8,
      "CriticalThreshold": 0.95
    }
  },

  "Observability": {
    "Metrics": {
      "Enabled": true,
      "PrometheusEnabled": true,
      "CollectionIntervalSeconds": 10,

      "Database": {
        "QueryDuration": true,
        "QueryCount": true,
        "ConnectionPoolUtilization": true,
        "PreparedStatementCacheHitRate": true
      },

      "Cache": {
        "HitRate": true,
        "Size": true,
        "Evictions": true,
        "OperationDuration": true
      }
    },

    "Tracing": {
      "Enabled": true,
      "SamplingRate": 0.1,
      "IncludeQueryText": false,
      "IncludeQueryParameters": false
    }
  },

  "Performance": {
    "EnablePreparedStatements": true,
    "PreparedStatementCacheSize": 100,

    "Pagination": {
      "DefaultPageSize": 100,
      "MaxPageSize": 10000,
      "PreferCursorPagination": true,
      "OffsetWarningThreshold": 1000
    },

    "QueryOptimization": {
      "EnableQueryPlanCaching": true,
      "EnableStatisticsCache": true,
      "StatisticsCacheTtlSeconds": 300
    }
  },

  "Comments": {
    "Configuration": "This is a performance-optimized configuration for Honua.Server",
    "DatabasePooling": "Auto-scaling enabled based on CPU cores (ProcessorCount * ScaleFactor)",
    "FeatureCaching": "Redis-backed caching with 5-minute default TTL",
    "CursorPagination": "Recommended for large result sets (> 1000 records)",
    "PreparedStatements": "Cached per connection for frequently-executed queries",
    "SlowQueryLogging": "Logs queries exceeding 500ms threshold",
    "Monitoring": "Metrics exported for Prometheus, tracing at 10% sampling rate"
  }
}
