# Container Vulnerability Scanning Overview

## Visual Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         GitHub Actions Workflows                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     CI Workflow (ci.yml)        â”‚  â”‚  Security Workflow              â”‚
â”‚                                 â”‚  â”‚  (container-security.yml)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Trigger:                        â”‚  â”‚ Trigger:                         â”‚
â”‚  â€¢ Every push/PR                â”‚  â”‚  â€¢ Daily @ 2AM UTC (scheduled)   â”‚
â”‚  â€¢ All branches                 â”‚  â”‚  â€¢ Push to master/main/dev       â”‚
â”‚                                 â”‚  â”‚  â€¢ Pull requests                 â”‚
â”‚ Jobs:                           â”‚  â”‚  â€¢ Manual dispatch               â”‚
â”‚  1. build                       â”‚  â”‚                                  â”‚
â”‚  2. unit-tests                  â”‚  â”‚ Jobs:                            â”‚
â”‚  3. infrastructure-tests        â”‚  â”‚  1. trivy-scan (matrix)          â”‚
â”‚  4. integration-tests           â”‚  â”‚     â€¢ OS packages                â”‚
â”‚  5. performance-tests           â”‚  â”‚     â€¢ Libraries                  â”‚
â”‚  6. qgis-smoke-tests            â”‚  â”‚  2. trivy-config-scan            â”‚
â”‚  7. âœ docker-build â­ NEW       â”‚  â”‚     â€¢ Dockerfile                 â”‚
â”‚  8. security-scan               â”‚  â”‚     â€¢ K8s manifests              â”‚
â”‚  9. test-summary                â”‚  â”‚  3. grype-scan                   â”‚
â”‚                                 â”‚  â”‚     â€¢ Alternative DB             â”‚
â”‚ docker-build Features:          â”‚  â”‚  4. docker-scout                 â”‚
â”‚  â€¢ Build production image       â”‚  â”‚     â€¢ Docker Hub CVEs            â”‚
â”‚  â€¢ Trivy scan (3 formats)       â”‚  â”‚  5. security-summary             â”‚
â”‚  â€¢ FAIL on HIGH/CRITICAL âŒ     â”‚  â”‚     â€¢ Aggregate results          â”‚
â”‚  â€¢ Upload to Security tab       â”‚  â”‚     â€¢ Generate report            â”‚
â”‚  â€¢ Upload artifacts (30d)       â”‚  â”‚     â€¢ PR comments                â”‚
â”‚  â€¢ Generate summary             â”‚  â”‚                                  â”‚
â”‚                                 â”‚  â”‚ Multi-Tool Strategy:             â”‚
â”‚ Build Policy:                   â”‚  â”‚  â€¢ Trivy (primary)               â”‚
â”‚  âœ… PASS: 0 HIGH/CRITICAL       â”‚  â”‚  â€¢ Grype (validation)            â”‚
â”‚  âŒ FAIL: 1+ HIGH/CRITICAL      â”‚  â”‚  â€¢ Docker Scout (Docker-native)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                                    â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚    GitHub Security Tab           â”‚
                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                 â”‚ Categories:                      â”‚
                 â”‚  â€¢ container-image (CI)          â”‚
                 â”‚  â€¢ trivy-os                      â”‚
                 â”‚  â€¢ trivy-library                 â”‚
                 â”‚  â€¢ trivy-config                  â”‚
                 â”‚  â€¢ grype                         â”‚
                 â”‚  â€¢ docker-scout                  â”‚
                 â”‚                                  â”‚
                 â”‚ Features:                        â”‚
                 â”‚  â€¢ Alert management              â”‚
                 â”‚  â€¢ Dismiss with reason           â”‚
                 â”‚  â€¢ Create issues                 â”‚
                 â”‚  â€¢ Track remediation             â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Scan Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Git Push    â”‚
â”‚  or PR       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CI Workflow Starts                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Build .NET solution              â”‚
â”‚  2. Run unit tests                   â”‚
â”‚  3. Run integration tests            â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  docker-build Job                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Step 1: Checkout code               â”‚
â”‚  Step 2: Setup Docker Buildx         â”‚
â”‚  Step 3: Build image                 â”‚
â”‚          â””â”€ Tag: honua:$SHA          â”‚
â”‚  Step 4: Trivy scan (SARIF)          â”‚
â”‚          â””â”€ Severity: HIGH,CRITICAL  â”‚
â”‚          â””â”€ Exit code: 1 (fail)      â”‚
â”‚  Step 5: Trivy scan (table)          â”‚
â”‚          â””â”€ All severities           â”‚
â”‚  Step 6: Trivy scan (JSON)           â”‚
â”‚          â””â”€ Machine-readable         â”‚
â”‚  Step 7: Upload to Security tab      â”‚
â”‚          â””â”€ Category: container-imageâ”‚
â”‚  Step 8: Upload artifacts            â”‚
â”‚          â””â”€ Retention: 30 days       â”‚
â”‚  Step 9: Generate summary            â”‚
â”‚          â””â”€ Vulnerability count      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€ âœ… No HIGH/CRITICAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Build continues
       â”‚
       â””â”€â”€â”€â”€ âŒ HIGH/CRITICAL found â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Build fails
                                                    â”‚
                                                    â–¼
                                          Notification sent
                                          Review required
```

## Scanning Tools Comparison

| Feature | Trivy | Grype | Docker Scout |
|---------|-------|-------|--------------|
| **Database** | NVD, OS advisories, GitHub | Anchore DB | Docker Hub |
| **Speed** | âš¡ Very Fast | âš¡ Fast | ğŸ¢ Moderate |
| **OS Packages** | âœ… Yes | âœ… Yes | âœ… Yes |
| **Libraries** | âœ… Yes | âœ… Yes | âœ… Yes |
| **Config Scan** | âœ… Yes | âŒ No | âŒ No |
| **SARIF Output** | âœ… Yes | âœ… Yes | âœ… Yes |
| **GitHub Integration** | âœ… Native | âœ… Via action | âœ… Via action |
| **False Positives** | ğŸŸ¢ Low | ğŸŸ¢ Low | ğŸŸ¡ Medium |
| **Update Frequency** | Daily | Daily | Real-time |
| **License** | Apache 2.0 | Apache 2.0 | Proprietary |

**Why Multiple Tools?**
- âœ… Cross-validation reduces false positives
- âœ… Different databases catch different CVEs
- âœ… Comprehensive coverage
- âœ… No single point of failure

## Vulnerability Severity Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Severity   â”‚ CVSS Score â”‚ Response Time â”‚      CI Action      â”‚  Security Action â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CRITICAL   â”‚  9.0-10.0  â”‚  Immediate    â”‚  âŒ FAIL BUILD      â”‚  Hotfix < 24h    â”‚
â”‚             â”‚            â”‚               â”‚                     â”‚  Emergency PR    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  HIGH       â”‚  7.0-8.9   â”‚  1-3 days     â”‚  âŒ FAIL BUILD      â”‚  Patch release   â”‚
â”‚             â”‚            â”‚               â”‚                     â”‚  Scheduled fix   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  MEDIUM     â”‚  4.0-6.9   â”‚  1-2 weeks    â”‚  âš ï¸ WARNING ONLY   â”‚  Minor release   â”‚
â”‚             â”‚            â”‚               â”‚  âœ… PASS BUILD      â”‚  Planned fix     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  LOW        â”‚  0.1-3.9   â”‚  Next sprint  â”‚  â„¹ï¸ INFO ONLY      â”‚  Backlog item    â”‚
â”‚             â”‚            â”‚               â”‚  âœ… PASS BUILD      â”‚  Review & triage â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Scan Output Formats

### 1. SARIF (Security Alert Reporting Interoperability Format)

**Purpose**: GitHub Security tab integration
**Upload**: Automatic via `codeql-action/upload-sarif`
**Features**:
- Structured vulnerability data
- Integrated with GitHub UI
- Alert management
- Historical tracking

```json
{
  "version": "2.1.0",
  "runs": [{
    "tool": { "driver": { "name": "Trivy" } },
    "results": [{
      "ruleId": "CVE-2024-5535",
      "level": "warning",
      "message": { "text": "OpenSSL vulnerability..." }
    }]
  }]
}
```

### 2. Table Format

**Purpose**: Human-readable output
**Use Case**: Quick review, PR comments
**Features**:
- ASCII table layout
- Key information visible
- Easy to scan visually

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Library  â”‚ CVE         â”‚ Severity â”‚ Installed   â”‚ Fixed       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ libssl3  â”‚ CVE-2024... â”‚ HIGH     â”‚ 3.1.4-2     â”‚ 3.1.5-1     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. JSON Format

**Purpose**: Automation and tooling
**Use Case**: Metrics, dashboards, SIEM
**Features**:
- Complete vulnerability details
- CVSS scores
- References and links
- Machine-parseable

```json
{
  "Results": [{
    "Vulnerabilities": [{
      "VulnerabilityID": "CVE-2024-5535",
      "Severity": "HIGH",
      "CVSS": { "nvd": { "V3Score": 7.5 } }
    }]
  }]
}
```

## Integration Points

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GitHub Security Features                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Code Scanning   â”‚  â”‚  Dependabot      â”‚  â”‚  Secret Scanning â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  â€¢ Trivy alerts  â”‚  â”‚  â€¢ NuGet updates â”‚  â”‚  â€¢ API keys      â”‚
â”‚  â€¢ Grype alerts  â”‚  â”‚  â€¢ Base images   â”‚  â”‚  â€¢ Credentials   â”‚
â”‚  â€¢ Scout alerts  â”‚  â”‚  â€¢ Auto PRs      â”‚  â”‚  â€¢ Tokens        â”‚
â”‚  â€¢ Config issues â”‚  â”‚  â€¢ Version bump  â”‚  â”‚  â€¢ Certificates  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                     â”‚                      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚   Security Overview         â”‚
                â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚
                â”‚   Unified dashboard         â”‚
                â”‚   Alert management          â”‚
                â”‚   Compliance tracking       â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Artifact Organization

```
Workflow Run Artifacts
â”‚
â”œâ”€ trivy-scan-results (CI workflow)
â”‚  â”œâ”€ trivy-results.sarif â”€â”€â”€â”€â”€â–º GitHub Security tab
â”‚  â”œâ”€ trivy-results.txt â”€â”€â”€â”€â”€â”€â”€â–º Human review
â”‚  â””â”€ trivy-results.json â”€â”€â”€â”€â”€â”€â–º Automation
â”‚
â”œâ”€ trivy-os-scan-results (Security workflow)
â”‚  â”œâ”€ trivy-os-results.sarif â”€â”€â–º GitHub Security tab
â”‚  â”œâ”€ trivy-os-results.txt â”€â”€â”€â”€â–º Human review
â”‚  â””â”€ trivy-os-results.json â”€â”€â”€â–º Automation
â”‚
â”œâ”€ trivy-library-scan-results (Security workflow)
â”‚  â”œâ”€ trivy-library-results.sarif
â”‚  â”œâ”€ trivy-library-results.txt
â”‚  â””â”€ trivy-library-results.json
â”‚
â”œâ”€ trivy-config-scan-results (Security workflow)
â”‚  â”œâ”€ trivy-config-results.sarif
â”‚  â””â”€ trivy-config-results.txt
â”‚
â”œâ”€ grype-scan-results (Security workflow)
â”‚  â””â”€ vulnerability-report.sarif
â”‚
â””â”€ docker-scout-scan-results (Security workflow)
   â””â”€ docker-scout-results.sarif

Retention:
  CI artifacts:       30 days
  Security artifacts: 90 days
```

## Workflow Schedule

```
Time (UTC)  Event                         Workflow
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
00:00       Nightly tests                 nightly-tests.yml
02:00       Security scan ğŸ”’              container-security.yml
04:00       Performance monitoring        performance-monitoring.yml
06:00       -
08:00       -
10:00       -
12:00       -
14:00       -
16:00       -
18:00       -
20:00       -
22:00       -
24:00       -

On Event:
  â€¢ Git push â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º ci.yml (includes docker-build)
  â€¢ Pull request â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º ci.yml, container-security.yml
  â€¢ Manual dispatch â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º container-security.yml
```

## Documentation Structure

```
docs/
â”œâ”€ CONTAINER_SECURITY.md â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Complete guide (15 KB)
â”‚  â”œâ”€ Overview
â”‚  â”œâ”€ Scanning strategy
â”‚  â”œâ”€ CI/CD integration
â”‚  â”œâ”€ Reviewing results
â”‚  â”œâ”€ Responding to vulnerabilities
â”‚  â”œâ”€ Local scanning
â”‚  â”œâ”€ Best practices
â”‚  â”œâ”€ Troubleshooting
â”‚  â””â”€ References
â”‚
â”œâ”€ SAMPLE_TRIVY_SCAN_OUTPUT.md â”€â”€â”€â”€â–º Example results (21 KB)
â”‚  â”œâ”€ Executive summary
â”‚  â”œâ”€ Detailed scan results
â”‚  â”œâ”€ Vulnerability breakdown
â”‚  â”œâ”€ CVE analysis
â”‚  â”œâ”€ Recommendations
â”‚  â””â”€ Risk assessment
â”‚
â””â”€ security/
   â””â”€ CONTAINER_SECURITY_QUICKSTART.md â”€â–º Quick reference (7 KB)
      â”œâ”€ TL;DR commands
      â”œâ”€ Local scanning
      â”œâ”€ Common tasks
      â”œâ”€ Troubleshooting
      â””â”€ Best practices
```

## Metrics Dashboard (Recommended)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Container Security Dashboard                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Current Status      â”‚  â”‚  Trend (30 days)     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  Total: 12           â”‚  â”‚  â–â–‚â–ƒâ–„â–…â–†â–‡â–ˆâ–‡â–†â–…â–„â–ƒâ–‚â–    â”‚
â”‚  â”œâ”€ CRITICAL: 0 âœ…   â”‚  â”‚  Decreasing âœ…       â”‚
â”‚  â”œâ”€ HIGH: 2 âš ï¸       â”‚  â”‚  -3 from last week   â”‚
â”‚  â”œâ”€ MEDIUM: 5 â„¹ï¸     â”‚  â”‚                      â”‚
â”‚  â””â”€ LOW: 5 â„¹ï¸        â”‚  â”‚  MTTR: 2.1 days âœ…   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Remediation         â”‚  â”‚  Scan Status         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚
â”‚  Fix Available: 100% â”‚  â”‚  Last: 2 hours ago   â”‚
â”‚  In Progress: 2      â”‚  â”‚  Next: 22 hours      â”‚
â”‚  Dismissed: 0        â”‚  â”‚  Status: âœ… Passing  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Top Vulnerabilities                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                            â”‚
â”‚  1. CVE-2024-5535 (HIGH) - libssl3              â”‚
â”‚     Fix: Update to 3.1.5-1                      â”‚
â”‚  2. CVE-2024-2961 (MEDIUM) - libc6              â”‚
â”‚     Fix: Update to 2.37-13                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Quick Reference Commands

```bash
# Build and scan locally
docker build -t honua:local .
trivy image --severity HIGH,CRITICAL honua:local

# View GitHub Security alerts
gh api repos/:owner/:repo/code-scanning/alerts

# Download latest scan results
gh run download --name trivy-scan-results

# Generate security report
trivy image --format json honua:local | jq '.Results[].Vulnerabilities'

# Check for updates
docker pull mcr.microsoft.com/dotnet/aspnet:9.0-noble-chiseled
docker inspect ... | jq '.[0].RootFS.Layers'
```

## Support Resources

- ğŸ“˜ [Complete Guide](../CONTAINER_SECURITY.md)
- ğŸš€ [Quick Start](CONTAINER_SECURITY_QUICKSTART.md)
- ğŸ“Š [Sample Output](../SAMPLE_TRIVY_SCAN_OUTPUT.md)
- ğŸ”’ [GitHub Security](https://github.com/honua/honua.next/security)
- ğŸ”§ [Workflow Runs](https://github.com/honua/honua.next/actions)

---

**Last Updated**: 2025-10-18
**Status**: âœ… Production Ready
