{
  "$schema": "../schemas/honua-configuration-schema.json",
  "ExternalServiceSecurity": {
    // =============================================================================
    // CORS CONFIGURATION: Allow SPA cross-origin access
    // =============================================================================
    "Cors": {
      // Enable CORS for SPA access (set to false to disable)
      "Enabled": true,

      // ALLOWED ORIGINS: Whitelist specific domains that can access Honua API
      // Best practices:
      // - Use specific domains (avoid "*" in production)
      // - Use HTTPS in production
      // - Wildcards: "https://*.example.com" matches all subdomains
      "AllowedOrigins": [
        "https://app.example.com",           // Production SPA
        "https://staging.example.com",       // Staging environment
        "https://*.dev.example.com",         // All dev subdomains
        "http://localhost:3000",             // Local React dev server
        "http://localhost:5173",             // Local Vite dev server
        "http://localhost:4200"              // Local Angular dev server
      ],

      // ALLOWED HTTP METHODS
      // Include all methods your SPA needs (GET for queries, POST for edits, etc.)
      "AllowedMethods": [
        "GET",
        "POST",
        "PUT",
        "DELETE",
        "OPTIONS",     // Required for preflight requests
        "PATCH"
      ],

      // ALLOWED REQUEST HEADERS
      // Headers that the browser can send in cross-origin requests
      "AllowedHeaders": [
        "Content-Type",       // Required for JSON requests
        "Authorization",      // Required for Bearer tokens
        "X-Requested-With",   // Common for AJAX requests
        "X-Api-Key",          // If using API key authentication
        "Accept",             // Content negotiation
        "Origin"              // CORS standard header
      ],

      // EXPOSED RESPONSE HEADERS
      // Headers that JavaScript can read from the response
      // Useful for pagination, rate limiting, etc.
      "ExposedHeaders": [
        "X-Total-Count",      // Total records for pagination
        "X-Page-Size",        // Page size
        "X-Page-Number",      // Current page
        "X-Rate-Limit",       // Rate limit remaining
        "X-Request-Id",       // Request tracking
        "Content-Range"       // Range requests
      ],

      // ALLOW CREDENTIALS
      // Set to true if your SPA needs to send cookies or Authorization headers
      // IMPORTANT: Cannot use "*" for AllowedOrigins if this is true
      "AllowCredentials": true,

      // PREFLIGHT CACHE MAX AGE (seconds)
      // How long browsers can cache the preflight OPTIONS response
      // Higher = better performance, but slower policy updates
      // Recommended: 3600 (1 hour) for production, 60 for dev
      "MaxAge": 3600,

      // ALLOW WILDCARD SUBDOMAINS
      // Enable pattern matching for "*.example.com"
      "AllowWildcardSubdomains": true
    },

    // =============================================================================
    // EXTERNAL SERVICE AUTHENTICATION (existing functionality)
    // =============================================================================
    "Profiles": {
      "esri_public": {
        "Type": "none",
        "Description": "Public ArcGIS REST services (no authentication)"
      },
      "esri_token": {
        "Type": "token",
        "Token": "${ESRI_TOKEN}",
        "Description": "ArcGIS token-based authentication"
      }
    }
  }
}
