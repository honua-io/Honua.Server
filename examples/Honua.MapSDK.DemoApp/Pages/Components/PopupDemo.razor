@page "/components/popup"
<PageTitle>Popup Demo - Honua MapSDK</PageTitle>

<div class="dashboard-container">
    <div class="dashboard-header">
        <div>
            <h1 class="dashboard-title">
                <MudIcon Icon="@Icons.Material.Filled.Info" Class="mr-2" />
                HonuaPopup Component
            </h1>
            <p class="dashboard-subtitle">
                Display feature information with click popups, hover tooltips, custom templates, and action buttons.
            </p>
        </div>
    </div>

    <MudTabs Elevation="2" Rounded="true" ApplyEffectsToContainer="true" PanelClass="pa-6" Color="Color.Primary">
        <!-- Click Popup -->
        <MudTabPanel Icon="@Icons.Material.Filled.TouchApp" Text="Click Popup">
            <MudText Typo="Typo.h6" Class="mb-3">Click to Show Popup</MudText>
            <MudText Typo="Typo.body1" Class="mb-4">
                Click on any feature to display a popup with detailed information.
            </MudText>

            <div style="height: 500px; margin-bottom: 24px;">
                <HonuaMap Id="popup-click-map"
                          MapStyle="https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json"
                          Center="new[] { -122.4194, 37.7749 }"
                          Zoom="13"
                          Style="width: 100%; height: 100%; border-radius: 8px;" />

                <HonuaPopup Id="click-popup"
                            SyncWith="popup-click-map"
                            TriggerMode="PopupTrigger.Click"
                            ShowCloseButton="true"
                            MaxWidth="400px"
                            Style="width: 100%; height: 100%;">
                    <ContentTemplate Context="feature">
                        <div style="padding: 16px;">
                            <MudText Typo="Typo.h6" Class="mb-2">@feature.Properties["address"]</MudText>
                            <MudDivider Class="mb-2" />
                            <MudText Typo="Typo.body2"><strong>Land Use:</strong> @feature.Properties["landUse"]</MudText>
                            <MudText Typo="Typo.body2"><strong>Assessed Value:</strong> $@feature.Properties["assessedValue"]</MudText>
                            <MudText Typo="Typo.body2"><strong>Area:</strong> @feature.Properties["sqft"] sqft</MudText>
                            <MudButton Variant="Variant.Filled" Color="Color.Primary" Size="Size.Small" Class="mt-2" FullWidth="true">
                                View Details
                            </MudButton>
                        </div>
                    </ContentTemplate>
                </HonuaPopup>
            </div>

            <div class="code-example">
                <pre><code>&lt;HonuaPopup SyncWith="my-map"
            TriggerMode="PopupTrigger.Click"
            ShowCloseButton="true"
            MaxWidth="400px"&gt;
    &lt;ContentTemplate Context="feature"&gt;
        &lt;div style="padding: 16px;"&gt;
            &lt;h3&gt;@@feature.Properties["name"]&lt;/h3&gt;
            &lt;p&gt;@@feature.Properties["description"]&lt;/p&gt;
        &lt;/div&gt;
    &lt;/ContentTemplate&gt;
&lt;/HonuaPopup&gt;</code></pre>
            </div>
        </MudTabPanel>

        <!-- Hover Tooltip -->
        <MudTabPanel Icon="@Icons.Material.Filled.Mouse" Text="Hover Tooltip">
            <MudText Typo="Typo.h6" Class="mb-3">Hover for Quick Info</MudText>
            <MudText Typo="Typo.body1" Class="mb-4">
                Hover over features to see a quick tooltip with basic information.
            </MudText>

            <div style="height: 500px; margin-bottom: 24px;">
                <HonuaMap Id="popup-hover-map"
                          MapStyle="https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json"
                          Center="new[] { -122.4194, 37.7749 }"
                          Zoom="13"
                          Style="width: 100%; height: 100%; border-radius: 8px;" />

                <HonuaPopup Id="hover-popup"
                            SyncWith="popup-hover-map"
                            TriggerMode="PopupTrigger.Hover"
                            ShowCloseButton="false"
                            CloseOnClick="false"
                            MaxWidth="300px"
                            Offset="10"
                            Style="width: 100%; height: 100%;">
                    <ContentTemplate Context="feature">
                        <div style="padding: 12px; background: rgba(0,0,0,0.8); color: white; border-radius: 4px;">
                            <MudText Typo="Typo.body2" Style="color: white;">
                                <strong>@feature.Properties["address"]</strong>
                            </MudText>
                            <MudText Typo="Typo.caption" Style="color: rgba(255,255,255,0.8);">
                                @feature.Properties["landUse"] - $@feature.Properties["assessedValue"]
                            </MudText>
                        </div>
                    </ContentTemplate>
                </HonuaPopup>
            </div>

            <MudAlert Severity="Severity.Info">
                Hover tooltips are great for quick information without cluttering the map with permanent popups.
            </MudAlert>

            <div class="code-example mt-4">
                <pre><code>&lt;HonuaPopup SyncWith="my-map"
            TriggerMode="PopupTrigger.Hover"
            ShowCloseButton="false"
            CloseOnClick="false"
            Offset="10"&gt;
    &lt;ContentTemplate Context="feature"&gt;
        &lt;div style="padding: 12px; background: rgba(0,0,0,0.8); color: white;"&gt;
            @@feature.Properties["name"]
        &lt;/div&gt;
    &lt;/ContentTemplate&gt;
&lt;/HonuaPopup&gt;</code></pre>
            </div>
        </MudTabPanel>

        <!-- Custom Templates -->
        <MudTabPanel Icon="@Icons.Material.Filled.DesignServices" Text="Custom">
            <MudText Typo="Typo.h6" Class="mb-3">Custom Popup Templates</MudText>
            <MudText Typo="Typo.body1" Class="mb-4">
                Create rich, interactive popups with custom templates, images, charts, and action buttons.
            </MudText>

            <div style="height: 500px; margin-bottom: 24px;">
                <HonuaMap Id="popup-custom-map"
                          MapStyle="https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json"
                          Center="new[] { -122.4194, 37.7749 }"
                          Zoom="13"
                          Style="width: 100%; height: 100%; border-radius: 8px;" />

                <HonuaPopup Id="custom-popup"
                            SyncWith="popup-custom-map"
                            TriggerMode="PopupTrigger.Click"
                            ShowCloseButton="true"
                            MaxWidth="450px"
                            Style="width: 100%; height: 100%;">
                    <ContentTemplate Context="feature">
                        <MudCard>
                            <MudCardHeader>
                                <CardHeaderContent>
                                    <MudText Typo="Typo.h6">@feature.Properties["address"]</MudText>
                                    <MudChip Size="Size.Small" Color="Color.Primary">@feature.Properties["landUse"]</MudChip>
                                </CardHeaderContent>
                                <CardHeaderActions>
                                    <MudIconButton Icon="@Icons.Material.Filled.Star" Color="Color.Warning" Size="Size.Small" />
                                </CardHeaderActions>
                            </MudCardHeader>
                            <MudCardContent>
                                <MudGrid>
                                    <MudItem xs="6">
                                        <MudText Typo="Typo.caption">Assessed Value</MudText>
                                        <MudText Typo="Typo.h6" Color="Color.Primary">$@feature.Properties["assessedValue"]</MudText>
                                    </MudItem>
                                    <MudItem xs="6">
                                        <MudText Typo="Typo.caption">Square Feet</MudText>
                                        <MudText Typo="Typo.h6">@feature.Properties["sqft"]</MudText>
                                    </MudItem>
                                </MudGrid>
                                <MudDivider Class="my-2" />
                                <MudText Typo="Typo.caption" Class="mb-1">Property Features</MudText>
                                <MudChipSet>
                                    <MudChip Size="Size.Small" Icon="@Icons.Material.Filled.Garage">2 Car Garage</MudChip>
                                    <MudChip Size="Size.Small" Icon="@Icons.Material.Filled.Pool">Pool</MudChip>
                                    <MudChip Size="Size.Small" Icon="@Icons.Material.Filled.Deck">Deck</MudChip>
                                </MudChipSet>
                            </MudCardContent>
                            <MudCardActions>
                                <MudButton Variant="Variant.Text" Color="Color.Primary" StartIcon="@Icons.Material.Filled.Info">Details</MudButton>
                                <MudButton Variant="Variant.Text" Color="Color.Secondary" StartIcon="@Icons.Material.Filled.Route">Directions</MudButton>
                                <MudButton Variant="Variant.Text" Color="Color.Success" StartIcon="@Icons.Material.Filled.Share">Share</MudButton>
                            </MudCardActions>
                        </MudCard>
                    </ContentTemplate>
                </HonuaPopup>
            </div>

            <div class="code-example">
                <pre><code>&lt;HonuaPopup SyncWith="my-map"&gt;
    &lt;ContentTemplate Context="feature"&gt;
        &lt;MudCard&gt;
            &lt;MudCardHeader&gt;
                &lt;MudText&gt;@@feature.Properties["name"]&lt;/MudText&gt;
            &lt;/MudCardHeader&gt;
            &lt;MudCardContent&gt;
                &lt;!-- Your custom content here --&gt;
            &lt;/MudCardContent&gt;
            &lt;MudCardActions&gt;
                &lt;MudButton&gt;Action&lt;/MudButton&gt;
            &lt;/MudCardActions&gt;
        &lt;/MudCard&gt;
    &lt;/ContentTemplate&gt;
&lt;/HonuaPopup&gt;</code></pre>
            </div>
        </MudTabPanel>

        <!-- Multi-feature -->
        <MudTabPanel Icon="@Icons.Material.Filled.SelectAll" Text="Multi-select">
            <MudText Typo="Typo.h6" Class="mb-3">Multiple Feature Selection</MudText>
            <MudText Typo="Typo.body1" Class="mb-4">
                When clicking on overlapping features, show a list to select which one to view.
            </MudText>

            <div style="height: 500px; margin-bottom: 24px;">
                <HonuaMap Id="popup-multi-map"
                          MapStyle="https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json"
                          Center="new[] { -122.4194, 37.7749 }"
                          Zoom="13"
                          Style="width: 100%; height: 100%; border-radius: 8px;" />

                <HonuaPopup Id="multi-popup"
                            SyncWith="popup-multi-map"
                            TriggerMode="PopupTrigger.Click"
                            ShowCloseButton="true"
                            AllowMultiSelect="true"
                            MaxWidth="350px"
                            Style="width: 100%; height: 100%;">
                    <MultiSelectTemplate Context="features">
                        <div style="padding: 16px;">
                            <MudText Typo="Typo.h6" Class="mb-2">@features.Count Features</MudText>
                            <MudDivider Class="mb-2" />
                            <MudList Dense="true">
                                @foreach (var feature in features)
                                {
                                    <MudListItem Icon="@Icons.Material.Filled.Place">
                                        <MudText Typo="Typo.body2">@feature.Properties["address"]</MudText>
                                    </MudListItem>
                                }
                            </MudList>
                        </div>
                    </MultiSelectTemplate>
                    <ContentTemplate Context="feature">
                        <div style="padding: 16px;">
                            <MudText Typo="Typo.h6">@feature.Properties["address"]</MudText>
                            <MudText Typo="Typo.body2">@feature.Properties["landUse"]</MudText>
                        </div>
                    </ContentTemplate>
                </HonuaPopup>
            </div>

            <MudAlert Severity="Severity.Success">
                Multi-select is useful for dense maps where features may overlap.
            </MudAlert>
        </MudTabPanel>

        <!-- API Reference -->
        <MudTabPanel Icon="@Icons.Material.Filled.Code" Text="API">
            <MudText Typo="Typo.h6" Class="mb-3">Component Properties</MudText>
            <MudSimpleTable Elevation="0" Dense="true">
                <thead>
                    <tr>
                        <th>Property</th>
                        <th>Type</th>
                        <th>Default</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>SyncWith</code></td>
                        <td>string</td>
                        <td>-</td>
                        <td>Map ID to synchronize with</td>
                    </tr>
                    <tr>
                        <td><code>TriggerMode</code></td>
                        <td>PopupTrigger</td>
                        <td>Click</td>
                        <td>Click, Hover, or Manual</td>
                    </tr>
                    <tr>
                        <td><code>ShowCloseButton</code></td>
                        <td>bool</td>
                        <td>true</td>
                        <td>Show close button</td>
                    </tr>
                    <tr>
                        <td><code>CloseOnClick</code></td>
                        <td>bool</td>
                        <td>true</td>
                        <td>Close when clicking elsewhere</td>
                    </tr>
                    <tr>
                        <td><code>MaxWidth</code></td>
                        <td>string</td>
                        <td>"350px"</td>
                        <td>Maximum popup width</td>
                    </tr>
                    <tr>
                        <td><code>Offset</code></td>
                        <td>int</td>
                        <td>10</td>
                        <td>Offset from anchor point (pixels)</td>
                    </tr>
                    <tr>
                        <td><code>AllowMultiSelect</code></td>
                        <td>bool</td>
                        <td>false</td>
                        <td>Show list for multiple features</td>
                    </tr>
                </tbody>
            </MudSimpleTable>

            <MudText Typo="Typo.h6" Class="mt-4 mb-3">Template Parameters</MudText>
            <MudSimpleTable Elevation="0" Dense="true">
                <thead>
                    <tr>
                        <th>Template</th>
                        <th>Context Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>ContentTemplate</code></td>
                        <td>Feature</td>
                        <td>Template for single feature popup</td>
                    </tr>
                    <tr>
                        <td><code>MultiSelectTemplate</code></td>
                        <td>List&lt;Feature&gt;</td>
                        <td>Template for multiple features</td>
                    </tr>
                </tbody>
            </MudSimpleTable>

            <MudText Typo="Typo.h6" Class="mt-4 mb-3">Events</MudText>
            <MudSimpleTable Elevation="0" Dense="true">
                <thead>
                    <tr>
                        <th>Event</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>OnPopupOpened</code></td>
                        <td>EventCallback&lt;Feature&gt;</td>
                        <td>Fired when popup opens</td>
                    </tr>
                    <tr>
                        <td><code>OnPopupClosed</code></td>
                        <td>EventCallback</td>
                        <td>Fired when popup closes</td>
                    </tr>
                </tbody>
            </MudSimpleTable>
        </MudTabPanel>
    </MudTabs>
</div>
