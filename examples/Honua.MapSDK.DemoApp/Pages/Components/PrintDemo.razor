@page "/components/print"
<PageTitle>Print Demo - Honua MapSDK</PageTitle>

<div class="dashboard-container">
    <div class="dashboard-header">
        <div>
            <h1 class="dashboard-title">
                <MudIcon Icon="@Icons.Material.Filled.Print" Class="mr-2" />
                HonuaPrint Component
            </h1>
            <p class="dashboard-subtitle">
                MapFish Print integration for creating high-quality PDF maps with layouts, legends, scale bars, and annotations.
            </p>
        </div>
    </div>

    <MudTabs Elevation="2" Rounded="true" ApplyEffectsToContainer="true" PanelClass="pa-6" Color="Color.Primary">
        <!-- Basic Print -->
        <MudTabPanel Icon="@Icons.Material.Filled.Print" Text="Basic">
            <MudGrid>
                <MudItem xs="12" md="8">
                    <div style="height: 600px;">
                        <HonuaMap Id="print-basic-map"
                                  MapStyle="https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json"
                                  Center="new[] { -122.4194, 37.7749 }"
                                  Zoom="13"
                                  Style="width: 100%; height: 100%; border-radius: 8px;" />
                    </div>
                </MudItem>
                <MudItem xs="12" md="4">
                    <div class="component-panel" style="height: 600px; overflow-y: auto;">
                        <div class="panel-header">
                            <h3 class="panel-title">Print Settings</h3>
                        </div>

                        <HonuaPrint Id="basic-print"
                                    SyncWith="print-basic-map"
                                    ShowPreview="true"
                                    Style="width: 100%;" />

                        <MudDivider Class="my-3" />

                        <MudText Typo="Typo.subtitle2" Class="mb-2">Quick Settings</MudText>
                        <MudStack Spacing="2">
                            <MudSelect Label="Paper Size" Variant="Variant.Outlined" Dense="true">
                                <MudSelectItem Value="@("A4")">A4 (210 × 297 mm)</MudSelectItem>
                                <MudSelectItem Value="@("Letter")">Letter (8.5 × 11")</MudSelectItem>
                                <MudSelectItem Value="@("A3")">A3 (297 × 420 mm)</MudSelectItem>
                                <MudSelectItem Value="@("Tabloid")">Tabloid (11 × 17")</MudSelectItem>
                            </MudSelect>

                            <MudSelect Label="Orientation" Variant="Variant.Outlined" Dense="true">
                                <MudSelectItem Value="@("portrait")">Portrait</MudSelectItem>
                                <MudSelectItem Value="@("landscape")">Landscape</MudSelectItem>
                            </MudSelect>

                            <MudTextField Label="Title" Variant="Variant.Outlined" Dense="true" />

                            <MudNumericField Label="Scale" T="int" Value="25000" Variant="Variant.Outlined" Dense="true" />

                            <MudButton Variant="Variant.Filled"
                                       Color="Color.Primary"
                                       StartIcon="@Icons.Material.Filled.Print"
                                       FullWidth="true"
                                       Class="mt-2">
                                Generate PDF
                            </MudButton>
                        </MudStack>
                    </div>
                </MudItem>
            </MudGrid>

            <div class="code-example mt-4">
                <pre><code>&lt;HonuaPrint Id="print"
            SyncWith="my-map"
            ShowPreview="true"
            PaperSize="A4"
            Orientation="landscape"
            OnPrintGenerated="HandlePrintGenerated" /&gt;</code></pre>
            </div>
        </MudTabPanel>

        <!-- Layouts -->
        <MudTabPanel Icon="@Icons.Material.Filled.ViewQuilt" Text="Layouts">
            <MudText Typo="Typo.h6" Class="mb-3">Print Layouts</MudText>
            <MudText Typo="Typo.body1" Class="mb-4">
                Choose from pre-configured layouts or create custom layouts with multiple map frames, legends, and text boxes.
            </MudText>

            <MudGrid>
                <MudItem xs="12" sm="6" md="3">
                    <MudCard>
                        <MudCardMedia Image="/images/layout-simple.png" Height="200" />
                        <MudCardContent>
                            <MudText Typo="Typo.h6">Simple</MudText>
                            <MudText Typo="Typo.body2">Single map, title, scale bar</MudText>
                        </MudCardContent>
                        <MudCardActions>
                            <MudButton Variant="Variant.Text" Color="Color.Primary">Select</MudButton>
                        </MudCardActions>
                    </MudCard>
                </MudItem>
                <MudItem xs="12" sm="6" md="3">
                    <MudCard>
                        <MudCardMedia Image="/images/layout-with-legend.png" Height="200" />
                        <MudCardContent>
                            <MudText Typo="Typo.h6">With Legend</MudText>
                            <MudText Typo="Typo.body2">Map + legend + metadata</MudText>
                        </MudCardContent>
                        <MudCardActions>
                            <MudButton Variant="Variant.Text" Color="Color.Primary">Select</MudButton>
                        </MudCardActions>
                    </MudCard>
                </MudItem>
                <MudItem xs="12" sm="6" md="3">
                    <MudCard>
                        <MudCardMedia Image="/images/layout-overview.png" Height="200" />
                        <MudCardContent>
                            <MudText Typo="Typo.h6">With Overview</MudText>
                            <MudText Typo="Typo.body2">Main map + overview map</MudText>
                        </MudCardContent>
                        <MudCardActions>
                            <MudButton Variant="Variant.Text" Color="Color.Primary">Select</MudButton>
                        </MudCardActions>
                    </MudCard>
                </MudItem>
                <MudItem xs="12" sm="6" md="3">
                    <MudCard>
                        <MudCardMedia Image="/images/layout-atlas.png" Height="200" />
                        <MudCardContent>
                            <MudText Typo="Typo.h6">Atlas</MudText>
                            <MudText Typo="Typo.body2">Multi-page series</MudText>
                        </MudCardContent>
                        <MudCardActions>
                            <MudButton Variant="Variant.Text" Color="Color.Primary">Select</MudButton>
                        </MudCardActions>
                    </MudCard>
                </MudItem>
            </MudGrid>

            <MudDivider Class="my-4" />

            <MudText Typo="Typo.h6" Class="mb-3">Layout Elements</MudText>
            <MudGrid>
                <MudItem xs="12" md="6">
                    <MudList Dense="true">
                        <MudListItem Icon="@Icons.Material.Filled.Map" IconColor="Color.Primary">
                            <MudText><strong>Map Frame:</strong> Main map display area</MudText>
                        </MudListItem>
                        <MudListItem Icon="@Icons.Material.Filled.Title" IconColor="Color.Primary">
                            <MudText><strong>Title Block:</strong> Map title and subtitle</MudText>
                        </MudListItem>
                        <MudListItem Icon="@Icons.Material.Filled.Info" IconColor="Color.Primary">
                            <MudText><strong>Legend:</strong> Layer symbols and labels</MudText>
                        </MudListItem>
                        <MudListItem Icon="@Icons.Material.Filled.Straighten" IconColor="Color.Primary">
                            <MudText><strong>Scale Bar:</strong> Graphic scale representation</MudText>
                        </MudListItem>
                    </MudList>
                </MudItem>
                <MudItem xs="12" md="6">
                    <MudList Dense="true">
                        <MudListItem Icon="@Icons.Material.Filled.Explore" IconColor="Color.Primary">
                            <MudText><strong>North Arrow:</strong> Orientation indicator</MudText>
                        </MudListItem>
                        <MudListItem Icon="@Icons.Material.Filled.TextFields" IconColor="Color.Primary">
                            <MudText><strong>Text Box:</strong> Custom annotations</MudText>
                        </MudListItem>
                        <MudListItem Icon="@Icons.Material.Filled.Image" IconColor="Color.Primary">
                            <MudText><strong>Logo/Image:</strong> Custom graphics</MudText>
                        </MudListItem>
                        <MudListItem Icon="@Icons.Material.Filled.Crop" IconColor="Color.Primary">
                            <MudText><strong>Inset Map:</strong> Overview or detail map</MudText>
                        </MudListItem>
                    </MudList>
                </MudItem>
            </MudGrid>
        </MudTabPanel>

        <!-- Preview -->
        <MudTabPanel Icon="@Icons.Material.Filled.Visibility" Text="Preview">
            <MudGrid>
                <MudItem xs="12" md="8">
                    <div class="component-panel" style="height: 700px; background: #F5F5F5; display: flex; align-items: center; justify-content: center;">
                        <div style="width: 90%; height: 90%; background: white; box-shadow: 0 4px 12px rgba(0,0,0,0.15); border-radius: 4px; padding: 40px;">
                            <MudText Typo="Typo.h4" Class="mb-2">San Francisco Property Map</MudText>
                            <MudText Typo="Typo.subtitle1" Color="Color.Secondary" Class="mb-4">Residential Parcels - 2024</MudText>

                            <div style="height: 500px; background: #E8F5E9; border: 2px solid #4CAF50; border-radius: 4px; display: flex; align-items: center; justify-content: center;">
                                <MudText Typo="Typo.h6" Color="Color.Secondary">MAP PREVIEW</MudText>
                            </div>

                            <MudGrid Class="mt-4">
                                <MudItem xs="8">
                                    <MudText Typo="Typo.caption">Scale: 1:25,000</MudText>
                                    <MudText Typo="Typo.caption">Projection: WGS84 / Web Mercator</MudText>
                                </MudItem>
                                <MudItem xs="4">
                                    <MudText Typo="Typo.caption" Align="Align.Right">Generated: @DateTime.Now.ToString("yyyy-MM-dd")</MudText>
                                    <MudText Typo="Typo.caption" Align="Align.Right">Page 1 of 1</MudText>
                                </MudItem>
                            </MudGrid>
                        </div>
                    </div>
                </MudItem>
                <MudItem xs="12" md="4">
                    <div class="component-panel">
                        <div class="panel-header">
                            <h3 class="panel-title">Preview Options</h3>
                        </div>

                        <MudStack Spacing="2">
                            <MudSelect Label="Zoom Level" Variant="Variant.Outlined" Dense="true">
                                <MudSelectItem Value="50">50%</MudSelectItem>
                                <MudSelectItem Value="75">75%</MudSelectItem>
                                <MudSelectItem Value="100">100%</MudSelectItem>
                                <MudSelectItem Value="150">150%</MudSelectItem>
                            </MudSelect>

                            <MudCheckBox Label="Show print margins" Dense="true" />
                            <MudCheckBox Label="Show safe area" Dense="true" />
                            <MudCheckBox Label="Show bleed area" Dense="true" />

                            <MudDivider Class="my-2" />

                            <MudButton Variant="Variant.Filled"
                                       Color="Color.Primary"
                                       StartIcon="@Icons.Material.Filled.Refresh"
                                       FullWidth="true">
                                Refresh Preview
                            </MudButton>

                            <MudButton Variant="Variant.Outlined"
                                       Color="Color.Secondary"
                                       StartIcon="@Icons.Material.Filled.Download"
                                       FullWidth="true">
                                Download PDF
                            </MudButton>
                        </MudStack>
                    </div>

                    <MudPaper Class="pa-3 mt-3" Elevation="1">
                        <MudText Typo="Typo.subtitle2" Class="mb-2">Print Quality</MudText>
                        <MudRadioGroup T="string" SelectedOption="@_printQuality">
                            <MudRadio Value="@("draft")" Color="Color.Default">Draft (72 DPI)</MudRadio>
                            <MudRadio Value="@("standard")" Color="Color.Primary">Standard (150 DPI)</MudRadio>
                            <MudRadio Value="@("high")" Color="Color.Success">High (300 DPI)</MudRadio>
                        </MudRadioGroup>
                    </MudPaper>
                </MudItem>
            </MudGrid>

            <MudAlert Severity="Severity.Info" Class="mt-4">
                <strong>Tip:</strong> Preview the map before generating PDF to ensure all elements are positioned correctly.
            </MudAlert>
        </MudTabPanel>

        <!-- Advanced -->
        <MudTabPanel Icon="@Icons.Material.Filled.Settings" Text="Advanced">
            <MudText Typo="Typo.h6" Class="mb-3">Advanced Print Options</MudText>

            <MudExpansionPanels MultiExpansion="true">
                <MudExpansionPanel Text="Map Configuration" IsInitiallyExpanded="true">
                    <MudGrid>
                        <MudItem xs="12" md="6">
                            <MudNumericField Label="DPI" T="int" Value="300" Variant="Variant.Outlined" Margin="Margin.Dense" />
                            <MudNumericField Label="Scale" T="int" Value="25000" Variant="Variant.Outlined" Margin="Margin.Dense" />
                            <MudSelect Label="Projection" Variant="Variant.Outlined" Margin="Margin.Dense">
                                <MudSelectItem Value="@("EPSG:4326")">WGS84 (EPSG:4326)</MudSelectItem>
                                <MudSelectItem Value="@("EPSG:3857")">Web Mercator (EPSG:3857)</MudSelectItem>
                                <MudSelectItem Value="@("EPSG:2163")">US National Atlas (EPSG:2163)</MudSelectItem>
                            </MudSelect>
                        </MudItem>
                        <MudItem xs="12" md="6">
                            <MudCheckBox Label="Include attribution" Checked="true" Dense="true" />
                            <MudCheckBox Label="Include scale bar" Checked="true" Dense="true" />
                            <MudCheckBox Label="Include north arrow" Checked="true" Dense="true" />
                            <MudCheckBox Label="Include grid" Dense="true" />
                        </MudItem>
                    </MudGrid>
                </MudExpansionPanel>

                <MudExpansionPanel Text="Legend Configuration">
                    <MudGrid>
                        <MudItem xs="12" md="6">
                            <MudCheckBox Label="Include legend" Checked="true" Dense="true" />
                            <MudCheckBox Label="Auto-size legend" Checked="true" Dense="true" />
                            <MudSelect Label="Legend Position" Variant="Variant.Outlined" Margin="Margin.Dense">
                                <MudSelectItem Value="@("right")">Right</MudSelectItem>
                                <MudSelectItem Value="@("left")">Left</MudSelectItem>
                                <MudSelectItem Value="@("bottom")">Bottom</MudSelectItem>
                            </MudSelect>
                        </MudItem>
                        <MudItem xs="12" md="6">
                            <MudSelect Label="Legend Columns" Variant="Variant.Outlined" Margin="Margin.Dense">
                                <MudSelectItem Value="1">1 Column</MudSelectItem>
                                <MudSelectItem Value="2">2 Columns</MudSelectItem>
                                <MudSelectItem Value="3">3 Columns</MudSelectItem>
                            </MudSelect>
                            <MudNumericField Label="Font Size" T="int" Value="10" Variant="Variant.Outlined" Margin="Margin.Dense" />
                        </MudItem>
                    </MudGrid>
                </MudExpansionPanel>

                <MudExpansionPanel Text="Metadata & Annotations">
                    <MudTextField Label="Title" Variant="Variant.Outlined" Margin="Margin.Dense" />
                    <MudTextField Label="Subtitle" Variant="Variant.Outlined" Margin="Margin.Dense" />
                    <MudTextField Label="Author" Variant="Variant.Outlined" Margin="Margin.Dense" />
                    <MudTextField Label="Copyright" Variant="Variant.Outlined" Margin="Margin.Dense" />
                    <MudTextField Label="Description" Lines="3" Variant="Variant.Outlined" Margin="Margin.Dense" />
                </MudExpansionPanel>

                <MudExpansionPanel Text="Page Setup">
                    <MudGrid>
                        <MudItem xs="12" md="6">
                            <MudNumericField Label="Margin Top (mm)" T="double" Value="10" Variant="Variant.Outlined" Margin="Margin.Dense" />
                            <MudNumericField Label="Margin Bottom (mm)" T="double" Value="10" Variant="Variant.Outlined" Margin="Margin.Dense" />
                        </MudItem>
                        <MudItem xs="12" md="6">
                            <MudNumericField Label="Margin Left (mm)" T="double" Value="10" Variant="Variant.Outlined" Margin="Margin.Dense" />
                            <MudNumericField Label="Margin Right (mm)" T="double" Value="10" Variant="Variant.Outlined" Margin="Margin.Dense" />
                        </MudItem>
                    </MudGrid>
                </MudExpansionPanel>
            </MudExpansionPanels>

            <MudDivider Class="my-4" />

            <div class="code-example">
                <pre><code>var printOptions = new PrintOptions
{
    PaperSize = "A4",
    Orientation = "landscape",
    DPI = 300,
    Scale = 25000,
    IncludeLegend = true,
    IncludeScaleBar = true,
    IncludeNorthArrow = true,
    Title = "Property Map",
    Author = "GIS Department"
};

await print.GeneratePdfAsync(printOptions);</code></pre>
            </div>
        </MudTabPanel>

        <!-- API Reference -->
        <MudTabPanel Icon="@Icons.Material.Filled.Code" Text="API">
            <MudText Typo="Typo.h6" Class="mb-3">Component Properties</MudText>
            <MudSimpleTable Elevation="0" Dense="true">
                <thead>
                    <tr>
                        <th>Property</th>
                        <th>Type</th>
                        <th>Default</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>SyncWith</code></td>
                        <td>string</td>
                        <td>-</td>
                        <td>Map ID to synchronize with</td>
                    </tr>
                    <tr>
                        <td><code>ShowPreview</code></td>
                        <td>bool</td>
                        <td>true</td>
                        <td>Show print preview</td>
                    </tr>
                    <tr>
                        <td><code>PaperSize</code></td>
                        <td>string</td>
                        <td>"A4"</td>
                        <td>Paper size (A4, Letter, A3, Tabloid)</td>
                    </tr>
                    <tr>
                        <td><code>Orientation</code></td>
                        <td>string</td>
                        <td>"portrait"</td>
                        <td>portrait or landscape</td>
                    </tr>
                    <tr>
                        <td><code>DPI</code></td>
                        <td>int</td>
                        <td>300</td>
                        <td>Print resolution (72-600)</td>
                    </tr>
                    <tr>
                        <td><code>Layout</code></td>
                        <td>string</td>
                        <td>"simple"</td>
                        <td>Layout template name</td>
                    </tr>
                    <tr>
                        <td><code>IncludeLegend</code></td>
                        <td>bool</td>
                        <td>true</td>
                        <td>Include legend in output</td>
                    </tr>
                </tbody>
            </MudSimpleTable>

            <MudText Typo="Typo.h6" Class="mt-4 mb-3">Methods</MudText>
            <MudSimpleTable Elevation="0" Dense="true">
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Returns</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>GeneratePdfAsync(options)</code></td>
                        <td>Task&lt;byte[]&gt;</td>
                        <td>Generate PDF with options</td>
                    </tr>
                    <tr>
                        <td><code>PreviewAsync()</code></td>
                        <td>Task&lt;string&gt;</td>
                        <td>Generate preview image URL</td>
                    </tr>
                    <tr>
                        <td><code>GetLayoutsAsync()</code></td>
                        <td>Task&lt;Layout[]&gt;</td>
                        <td>Get available layouts</td>
                    </tr>
                </tbody>
            </MudSimpleTable>

            <MudText Typo="Typo.h6" Class="mt-4 mb-3">Events</MudText>
            <MudSimpleTable Elevation="0" Dense="true">
                <thead>
                    <tr>
                        <th>Event</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>OnPrintGenerated</code></td>
                        <td>EventCallback&lt;byte[]&gt;</td>
                        <td>Fired when PDF is generated</td>
                    </tr>
                    <tr>
                        <td><code>OnPrintError</code></td>
                        <td>EventCallback&lt;string&gt;</td>
                        <td>Fired when print fails</td>
                    </tr>
                </tbody>
            </MudSimpleTable>
        </MudTabPanel>
    </MudTabs>
</div>

@code {
    private string _printQuality = "high";
}
