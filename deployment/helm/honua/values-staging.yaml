# Staging environment values
# Mirrors production with reduced resources

# Staging-specific settings
api:
  replicaCount: 2

  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 1Gi

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 5

  image:
    pullPolicy: Always

intake:
  replicaCount: 1

  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 1Gi

  autoscaling:
    enabled: true
    minReplicas: 1
    maxReplicas: 4

  image:
    pullPolicy: Always

orchestrator:
  replicaCount: 1

  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 2Gi

  autoscaling:
    enabled: true
    minReplicas: 1
    maxReplicas: 3

  image:
    pullPolicy: Always

# PostgreSQL - Moderate resources for staging
postgresql:
  enabled: true

  primary:
    persistence:
      enabled: true
      size: 30Gi

    resources:
      requests:
        cpu: 250m
        memory: 512Mi
      limits:
        cpu: 1000m
        memory: 2Gi

# Redis - Moderate resources for staging
redis:
  enabled: true

  master:
    persistence:
      enabled: true
      size: 5Gi

    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 512Mi

# Ingress with TLS
ingress:
  enabled: true
  className: "nginx"

  annotations:
    cert-manager.io/cluster-issuer: "letsencrypt-staging"
    nginx.ingress.kubernetes.io/ssl-redirect: "true"

  hosts:
    - host: api.staging.honua.example.com
      paths:
        - path: /
          pathType: Prefix
          service: api
    - host: intake.staging.honua.example.com
      paths:
        - path: /
          pathType: Prefix
          service: intake

  tls:
    - secretName: honua-staging-tls
      hosts:
        - api.staging.honua.example.com
        - intake.staging.honua.example.com

# Moderate PVCs for staging
persistence:
  logs:
    enabled: true
    size: 10Gi

  buildWorkspace:
    enabled: true
    size: 50Gi

  buildCache:
    enabled: true
    size: 25Gi

# Staging configuration
config:
  aspnetcore:
    environment: Staging

  honua:
    authentication:
      quickStart:
        enabled: false

# Enable network policies
networkPolicy:
  enabled: true

# Enable monitoring in staging
prometheus:
  enabled: true

grafana:
  enabled: true
  adminPassword: "CHANGEME_STAGING_GRAFANA_PASSWORD"

# Cloud provider can be configured per environment
cloudProvider:
  type: "generic"  # Change to aws, azure, or gcp as needed
