apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "honua.fullname" . }}-config
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "honua.labels" . | nindent 4 }}
data:
  # Server configuration
  ASPNETCORE_ENVIRONMENT: {{ .Values.config.aspnetcore.environment | quote }}
  ASPNETCORE_URLS: {{ .Values.config.aspnetcore.urls | quote }}

  # Honua pagination
  honua__pagination__defaultLimit: {{ .Values.config.honua.pagination.defaultLimit | quote }}
  honua__pagination__maxLimit: {{ .Values.config.honua.pagination.maxLimit | quote }}

  # API Versioning
  honua__apiVersioning__defaultVersion: {{ .Values.config.honua.apiVersioning.defaultVersion | quote }}
  honua__apiVersioning__assumeDefaultVersionWhenUnspecified: {{ .Values.config.honua.apiVersioning.assumeDefaultVersionWhenUnspecified | quote }}
  honua__apiVersioning__reportApiVersions: {{ .Values.config.honua.apiVersioning.reportApiVersions | quote }}
  honua__apiVersioning__versioningMethod: {{ .Values.config.honua.apiVersioning.versioningMethod | quote }}

  # Authentication
  honua__authentication__mode: {{ .Values.config.honua.authentication.mode | quote }}
  honua__authentication__enforce: {{ .Values.config.honua.authentication.enforce | quote }}
  honua__authentication__quickStart__enabled: {{ .Values.config.honua.authentication.quickStart.enabled | quote }}

  # OData
  honua__odata__enabled: {{ .Values.config.honua.odata.enabled | quote }}
  honua__odata__allowWrites: {{ .Values.config.honua.odata.allowWrites | quote }}
  honua__odata__defaultPageSize: {{ .Values.config.honua.odata.defaultPageSize | quote }}
  honua__odata__maxPageSize: {{ .Values.config.honua.odata.maxPageSize | quote }}

  # Observability
  observability__logging__jsonConsole: {{ .Values.config.observability.logging.jsonConsole | quote }}
  observability__logging__includeScopes: {{ .Values.config.observability.logging.includeScopes | quote }}
  observability__metrics__enabled: {{ .Values.config.observability.metrics.enabled | quote }}
  observability__metrics__endpoint: {{ .Values.config.observability.metrics.endpoint | quote }}
  observability__metrics__usePrometheus: {{ .Values.config.observability.metrics.usePrometheus | quote }}

  # Resilience
  Resilience__Hedging__Enabled: {{ .Values.config.resilience.hedging.enabled | quote }}
  Resilience__Hedging__MaxHedgedAttempts: {{ .Values.config.resilience.hedging.maxHedgedAttempts | quote }}
  Resilience__Hedging__DelayMilliseconds: {{ .Values.config.resilience.hedging.delayMilliseconds | quote }}
  Resilience__Hedging__TimeoutSeconds: {{ .Values.config.resilience.hedging.timeoutSeconds | quote }}
