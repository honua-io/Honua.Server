# ============================================================================
# AWS CloudFront CDN Configuration Example
# ============================================================================
# Copy this file to cdn-cloudfront.tfvars and customize for your deployment
# Usage: terraform apply -var-file="cdn-cloudfront.tfvars"
# ============================================================================

# Custom Domain Configuration
# Leave empty to use CloudFront's default domain (xxxxx.cloudfront.net)
domain_name = "tiles.honua.io"

# Origin Configuration
# Your Honua server endpoint (ALB, NLB, or public IP/hostname)
origin_domain_name = "honua-alb-123456789.us-east-1.elb.amazonaws.com"

# S3 Raster Cache (Optional)
# If you're using S3 for raster tile caching, specify the bucket name
# Leave empty if not using S3 cache
s3_raster_cache_bucket = "honua-raster-cache-prod"

# CloudFront Price Class
# - PriceClass_All: All edge locations (most expensive, best global coverage)
# - PriceClass_200: US, Canada, Europe, Asia, Middle East, Africa
# - PriceClass_100: US, Canada, Europe (cheapest)
price_class = "PriceClass_100"

# Geographic Restrictions
# Enable to restrict access by country
enable_geo_restriction = false

# Allowed countries (ISO 3166-1 alpha-2 codes)
# Only used if enable_geo_restriction = true
allowed_countries = ["US", "CA", "MX", "GB", "DE", "FR", "JP", "AU"]

# WAF Configuration
# Enable AWS WAF for DDoS and application-layer protection
# Additional cost: ~$5/month base + $1/million requests
enable_waf = true

# Environment
# Used for resource naming and tagging
environment = "prod"

# ============================================================================
# Example Configurations by Use Case
# ============================================================================

# Example 1: Global Deployment (Maximum Coverage)
# domain_name                = "tiles.honua.io"
# origin_domain_name         = "honua.example.com"
# s3_raster_cache_bucket     = "honua-raster-cache-prod"
# price_class                = "PriceClass_All"
# enable_geo_restriction     = false
# enable_waf                 = true
# environment                = "prod"

# Example 2: US-Only Deployment (Cost Optimized)
# domain_name                = "tiles.honua.io"
# origin_domain_name         = "honua.example.com"
# s3_raster_cache_bucket     = ""
# price_class                = "PriceClass_100"
# enable_geo_restriction     = true
# allowed_countries          = ["US", "CA"]
# enable_waf                 = false
# environment                = "prod"

# Example 3: Development/Staging
# domain_name                = "tiles-dev.honua.io"
# origin_domain_name         = "honua-dev.example.com"
# s3_raster_cache_bucket     = ""
# price_class                = "PriceClass_100"
# enable_geo_restriction     = false
# enable_waf                 = false
# environment                = "dev"

# ============================================================================
# Cost Estimates (Monthly)
# ============================================================================
#
# Base Configuration (PriceClass_100, no WAF):
#   - CloudFront requests: $0.0075/10,000 requests
#   - Data transfer out: $0.085/GB (first 10 TB)
#   - Example: 10M requests, 1TB transfer = ~$93/month
#
# With WAF:
#   - WAF base: $5/month
#   - WAF requests: $1/million requests
#   - Example: 10M requests = $15/month
#
# With PriceClass_All:
#   - Add ~30% to data transfer costs
#
# Invalidations:
#   - First 1,000 paths/month: FREE
#   - Additional paths: $0.005/path
#
# ============================================================================
# Notes
# ============================================================================
#
# 1. ACM Certificate:
#    - Must be in us-east-1 region (CloudFront requirement)
#    - Create before running terraform if using custom domain
#
# 2. DNS Configuration:
#    - After deployment, create CNAME record:
#      tiles.honua.io â†’ d111111abcdef8.cloudfront.net
#
# 3. Origin Verify Header:
#    - Terraform outputs a secret header value
#    - Configure Honua server to validate this header
#    - Prevents direct origin access (bypass CDN)
#
# 4. S3 Bucket:
#    - Must exist before deployment
#    - CloudFront will create OAI and update bucket policy
#
# 5. WAF Rules:
#    - Includes AWS Managed Rules (Common, Known Bad Inputs)
#    - Rate limiting: 2000 requests/min per IP
#    - Customize in cdn-cloudfront.tf if needed
#
# ============================================================================
