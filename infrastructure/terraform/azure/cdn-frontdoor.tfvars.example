# ============================================================================
# Azure Front Door CDN Configuration Example
# ============================================================================
# Copy this file to cdn-frontdoor.tfvars and customize for your deployment
# Usage: terraform apply -var-file="cdn-frontdoor.tfvars"
# ============================================================================

# Resource Group
# Must already exist
resource_group_name = "rg-honua-prod"

# Azure Region
# Front Door is global, but resources are created in this region
location = "eastus"

# Custom Domain
# Leave empty to use Front Door's default domain
custom_domain = "tiles.honua.io"

# Origin Configuration
# Your Honua server endpoint (Container App, AKS, App Service, VM)
origin_hostname = "honua-app.azurecontainerapps.io"

# Storage Account (Optional)
# If using Azure Blob Storage for raster cache
storage_account_name = "honuarastercache"

# WAF Configuration
# Premium tier required for WAF
# Standard tier: No WAF, lower cost
# Premium tier: Integrated WAF, DDoS protection
enable_waf = true

# Environment
# Used for resource naming and tagging
environment = "prod"

# ============================================================================
# Example Configurations by Use Case
# ============================================================================

# Example 1: Production with WAF (Premium Tier)
# resource_group_name  = "rg-honua-prod"
# location             = "eastus"
# custom_domain        = "tiles.honua.io"
# origin_hostname      = "honua-app.azurecontainerapps.io"
# storage_account_name = "honuarastercache"
# enable_waf           = true
# environment          = "prod"

# Example 2: Cost-Optimized (Standard Tier, No WAF)
# resource_group_name  = "rg-honua-prod"
# location             = "eastus"
# custom_domain        = "tiles.honua.io"
# origin_hostname      = "honua-app.azurecontainerapps.io"
# storage_account_name = ""
# enable_waf           = false
# environment          = "prod"

# Example 3: Development/Staging
# resource_group_name  = "rg-honua-dev"
# location             = "eastus"
# custom_domain        = "tiles-dev.honua.io"
# origin_hostname      = "honua-dev-app.azurecontainerapps.io"
# storage_account_name = ""
# enable_waf           = false
# environment          = "dev"

# ============================================================================
# Cost Estimates (Monthly)
# ============================================================================
#
# Standard Tier:
#   - Base cost: ~$35/month
#   - Requests: $0.0100/10,000 requests (first 1B)
#   - Data transfer out: $0.081/GB (first 10 TB)
#   - Example: 10M requests, 1TB transfer = ~$126/month
#
# Premium Tier (with WAF):
#   - Base cost: ~$330/month
#   - Requests: $0.0200/10,000 requests (first 1B)
#   - Data transfer out: $0.081/GB (first 10 TB)
#   - WAF: Included
#   - DDoS Protection: Included
#   - Example: 10M requests, 1TB transfer = ~$431/month
#
# Cache Purge:
#   - $0.02 per purge request (flat fee, any number of paths)
#
# ============================================================================
# Notes
# ============================================================================
#
# 1. Custom Domain Validation:
#    - After deployment, Azure provides a validation token
#    - Create TXT record: _dnsauth.tiles.honua.io with token
#    - Validation typically takes 5-10 minutes
#
# 2. Managed Certificate:
#    - Azure automatically provisions SSL certificate
#    - Renews automatically before expiration
#    - No additional cost
#
# 3. Health Probes:
#    - Front Door probes /health endpoint every 30 seconds
#    - Ensure your Honua server responds to health checks
#
# 4. WAF Managed Rules:
#    - Default Rule Set (DRS 1.0)
#    - Bot Manager Rule Set
#    - Custom rate limiting: 2000 requests/min per IP
#
# 5. Storage Integration:
#    - If using Azure Blob Storage for raster cache
#    - Storage account must exist in same subscription
#    - Front Door creates origin for direct blob access
#
# 6. Diagnostic Logging:
#    - Terraform creates Log Analytics workspace
#    - Logs: Access logs, health probes, WAF logs
#    - Retention: 30 days (customize in .tf file)
#
# 7. Premium vs Standard:
#    - Premium: WAF, private link, advanced routing
#    - Standard: Basic caching and routing
#    - Cannot change tier after creation (must recreate)
#
# ============================================================================
