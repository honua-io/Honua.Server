# Example Terraform Variables for Azure Container Apps Deployment
# Copy this file to terraform.tfvars and customize for your environment

# ==================== Required Variables ====================
environment     = "production"  # dev, staging, or production
container_image = "myregistry.azurecr.io/honua:latest"

# ==================== General Configuration ====================
service_name          = "honua"
location              = "eastus"  # eastus, westus2, northeurope, etc.
aspnetcore_environment = "Production"

# ==================== Resource Group ====================
create_resource_group = true
# resource_group_name = "existing-rg"  # If create_resource_group = false

# ==================== Container Configuration ====================
container_cpu    = 1     # 0.25, 0.5, 0.75, 1, 1.25, 1.5, 1.75, or 2
container_memory = "2Gi" # 0.5Gi, 1Gi, 1.5Gi, 2Gi, 3Gi, 3.5Gi, or 4Gi

# ==================== Scaling Configuration ====================
min_replicas             = 0   # 0 for true serverless
max_replicas             = 30  # Max 30 for Container Apps
scale_concurrent_requests = 10 # Requests per replica before scaling

# ==================== Virtual Network ====================
create_vnet        = true
vnet_address_space = "10.0.0.0/16"

# Using existing VNet (if create_vnet = false)
# container_apps_subnet_id = "/subscriptions/.../subnets/ca-subnet"
# postgresql_subnet_id     = "/subscriptions/.../subnets/db-subnet"

# ==================== Database Configuration ====================
create_database          = true
database_name            = "honua"
db_username              = "honua"
postgres_version         = "15"  # 11, 12, 13, 14, 15, or 16
db_sku_name              = "B_Standard_B1ms"  # B_Standard_B1ms, GP_Standard_D2s_v3, etc.
db_storage_mb            = 32768  # 32 GB
db_backup_retention_days = 7
db_geo_redundant_backup  = false
db_high_availability_mode = "Disabled"  # Disabled, ZoneRedundant, or SameZone
db_standby_zone          = "2"
db_max_connections       = "100"
db_shared_buffers        = "32000"

# ==================== Key Vault ====================
create_key_vault = true

# ==================== Azure Front Door ====================
create_front_door = true
front_door_sku    = "Standard_AzureFrontDoor"  # Standard or Premium

# Custom domains (requires DNS zone)
custom_domains = []
# custom_domains = ["api.honua.io", "gis.honua.io"]
# dns_zone_id    = "/subscriptions/.../dnszones/honua.io"

# ==================== Logging and Monitoring ====================
create_log_analytics = true
# log_analytics_workspace_id = "/subscriptions/.../workspaces/my-law"
log_retention_days = 30

# ==================== Security ====================
enable_storage_access = true  # Grant blob storage access

# ==================== Application Configuration ====================
cors_origins = [
  "https://honua.example.com",
  "https://app.honua.example.com",
  # "http://localhost:3000",  # Development
]

gdal_cache_max = "512"  # MB

# Additional environment variables
additional_env_vars = {
  # FEATURE_FLAG_NEW_RENDERER = "true"
  # LOG_LEVEL                 = "Information"
}

# ==================== Health Check ====================
health_check_path = "/health"

# ==================== Tags ====================
tags = {
  Team        = "Platform"
  CostCenter  = "Engineering"
  Application = "Honua"
  Tier        = "Production"
}

# ==================== Cost Optimization Notes ====================
#
# For Development (Minimal Cost ~$15-25/month):
# - min_replicas = 0
# - max_replicas = 5
# - container_cpu = 0.5
# - container_memory = "1Gi"
# - db_sku_name = "B_Standard_B1ms"
# - db_high_availability_mode = "Disabled"
# - create_front_door = false
#
# For Staging (~$50-100/month):
# - min_replicas = 0
# - max_replicas = 10
# - container_cpu = 1
# - container_memory = "2Gi"
# - db_sku_name = "GP_Standard_D2s_v3"
# - create_front_door = true
# - front_door_sku = "Standard_AzureFrontDoor"
#
# For Production (~$200-500/month):
# - min_replicas = 2 (always-on for low latency)
# - max_replicas = 30
# - container_cpu = 2
# - container_memory = "4Gi"
# - db_sku_name = "GP_Standard_D4s_v3"
# - db_high_availability_mode = "ZoneRedundant"
# - db_geo_redundant_backup = true
# - create_front_door = true
# - front_door_sku = "Premium_AzureFrontDoor" (includes WAF)
# - log_retention_days = 90
