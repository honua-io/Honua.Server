# Example Terraform Variables for CDN Module
# Copy this file to terraform.tfvars and customize for your cloud provider

# ==================== Required Variables ====================
cloud_provider = "aws"  # aws, gcp, or azure
environment    = "production"
service_name   = "honua"
origin_domain  = "honua-prod-alb-123456.us-east-1.elb.amazonaws.com"

# ==================== Origin Configuration ====================
origin_type            = "custom"  # custom or s3 (AWS only)
origin_protocol_policy = "https-only"  # http-only, https-only, or match-viewer

# ==================== Cache TTL Configuration ====================
# Tiles (WMS, WMTS, XYZ) - Cache aggressively
tiles_ttl     = 3600   # 1 hour (recommended for most tiles)
tiles_min_ttl = 0      # Allow origin to set lower if needed
tiles_max_ttl = 86400  # 24 hours maximum

# Features (OGC API Features, GeoJSON) - Cache moderately
features_ttl     = 300   # 5 minutes (balance freshness and performance)
features_min_ttl = 0
features_max_ttl = 3600  # 1 hour maximum

# Metadata (Collections, Capabilities) - Cache heavily
metadata_ttl     = 86400  # 24 hours (rarely changes)
metadata_min_ttl = 0
metadata_max_ttl = 604800 # 1 week maximum

# ==================== SSL Configuration ====================
custom_domains = ["api.honua.io", "gis.honua.io"]

# AWS ACM certificate ARN (must be in us-east-1 for CloudFront)
ssl_certificate_arn = "arn:aws:acm:us-east-1:123456789012:certificate/12345678-1234-1234-1234-123456789012"

# ==================== AWS CloudFront Specific ====================
aws_region             = "us-east-1"  # CloudFront requires us-east-1
cloudfront_price_class = "PriceClass_All"  # PriceClass_100, PriceClass_200, or PriceClass_All

# Logging (optional)
cloudfront_logging_bucket = "my-cloudfront-logs.s3.amazonaws.com"

# WAF (optional)
waf_web_acl_arn = ""  # "arn:aws:wafv2:us-east-1:123456789012:global/webacl/honua-waf/..."

# Geo-restriction (optional)
geo_restriction_type      = "none"  # none, whitelist, or blacklist
geo_restriction_locations = []      # ["US", "CA", "GB"] - ISO 3166-1-alpha-2 codes

# Origin Shield (reduces origin load, additional cost)
enable_origin_shield  = false
origin_shield_region  = ""  # "us-east-1" - closest to origin

# Headers to forward to origin
forwarded_headers = [
  "Host",
  "CloudFront-Forwarded-Proto",
  "CloudFront-Is-Desktop-Viewer",
  "CloudFront-Is-Mobile-Viewer"
]

# ==================== Azure Front Door Specific ====================
# Set to true if creating standalone Front Door (not in container-apps module)
create_azure_front_door   = false
azure_resource_group_name = "honua-prod-rg"
azure_front_door_sku      = "Standard_AzureFrontDoor"  # Standard or Premium

health_check_path = "/health"

# ==================== Tags ====================
tags = {
  Team        = "Platform"
  CostCenter  = "Engineering"
  Application = "Honua"
  Component   = "CDN"
}

# ==================== Configuration Notes ====================
#
# For Development:
# - tiles_ttl = 300 (5 minutes - faster iteration)
# - features_ttl = 60 (1 minute)
# - cloudfront_price_class = "PriceClass_100" (US/Europe only)
# - enable_origin_shield = false
#
# For Production:
# - tiles_ttl = 3600 (1 hour - optimal performance)
# - features_ttl = 300 (5 minutes)
# - metadata_ttl = 86400 (24 hours)
# - cloudfront_price_class = "PriceClass_All" (global)
# - enable_origin_shield = true (if high traffic)
# - waf_web_acl_arn = "..." (enable WAF)
#
# Cache Hit Ratio Optimization:
# - Longer TTLs = higher cache hit ratio
# - Monitor CloudWatch metrics
# - Target >70% cache hit ratio for tiles
# - Use Origin Shield to reduce origin load by 30-50%
#
# Cost Optimization:
# - PriceClass_100: US, Mexico, Canada, Europe (cheapest)
# - PriceClass_200: + South America, Japan, Australia
# - PriceClass_All: All edge locations (most expensive)
# - Origin Shield: $0.01 per 10,000 requests (saves on data transfer)
#
# Query String Caching:
# The module automatically caches based on these parameters:
# - Tiles: bbox, width, height, layers, srs, crs, format, time
# - Features: bbox, limit, offset, filter, crs
# - Metadata: All query parameters
#
# This ensures proper cache keys while maximizing cache hits.
