{
  "TrustedProxies": [],
  "_ConnectionStrings_Comment": "Redis connection string must be configured in appsettings.Development.json or appsettings.Production.json",
  "SecurityHeaders": {
    "_comment": "OWASP-recommended security headers for protecting against common web vulnerabilities",
    "Enabled": true,
    "EnableHsts": true,
    "HstsProductionOnly": false,
    "RemoveServerHeaders": true,
    "AllowUnsafeInlineInDevelopment": true,
    "AllowUnsafeEvalInDevelopment": true,
    "_StrictTransportSecurity_comment": "Leave null to use environment-based defaults (31536000 for Production, 86400 for Development)",
    "StrictTransportSecurity": null,
    "_ContentSecurityPolicy_comment": "Leave null to use environment-based defaults. Use {nonce} placeholder for dynamic nonce injection",
    "ContentSecurityPolicy": null,
    "ReferrerPolicy": "strict-origin-when-cross-origin",
    "PermissionsPolicy": "accelerometer=(), camera=(), geolocation=(), gyroscope=(), magnetometer=(), microphone=(), payment=(), usb=()",
    "XFrameOptions": "DENY",
    "XContentTypeOptions": "nosniff",
    "XPermittedCrossDomainPolicies": "none",
    "CrossOriginEmbedderPolicy": "require-corp",
    "_CrossOriginEmbedderPolicy_comment": "Controls loading of cross-origin resources. 'require-corp' provides strongest isolation against Spectre attacks.",
    "CrossOriginOpenerPolicy": "same-origin",
    "_CrossOriginOpenerPolicy_comment": "Controls cross-origin window interactions. 'same-origin' prevents certain cross-origin attacks.",
    "CrossOriginResourcePolicy": "same-origin",
    "_CrossOriginResourcePolicy_comment": "Controls which origins can load this resource. 'same-origin' is most restrictive."
  },
  "Serilog": {
    "Using": [ "Serilog.Sinks.Console", "Serilog.Sinks.File", "Serilog.Sinks.Seq" ],
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "Microsoft.AspNetCore": "Warning",
        "System": "Warning"
      }
    },
    "WriteTo": [
      {
        "Name": "Console",
        "Args": {
          "outputTemplate": "[{Timestamp:HH:mm:ss} {Level:u3}] {Message:lj} {Properties:j}{NewLine}{Exception}"
        }
      },
      {
        "Name": "File",
        "Args": {
          "path": "logs/honua-.log",
          "rollingInterval": "Day",
          "retainedFileCountLimit": 30,
          "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {Message:lj} {Properties:j}{NewLine}{Exception}"
        }
      }
    ],
    "Enrich": [ "FromLogContext", "WithMachineName", "WithThreadId", "WithEnvironmentName" ],
    "Properties": {
      "Application": "Honua.Server"
    }
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "observability": {
    "_comment": "Observability configuration for metrics, tracing, logs, and request logging. Override in environment-specific configs.",
    "cloudProvider": "none",
    "_comment_cloudProvider": "Cloud provider for native observability: 'none', 'aws', 'azure', 'gcp'",
    "logging": {
      "jsonConsole": true,
      "_comment_jsonConsole": "Use JSON format for console logs (true for production, false for dev readability)",
      "includeScopes": true,
      "_comment_includeScopes": "Include logging scopes for better context",
      "exporter": "none",
      "_comment_exporter": "Log exporter type: 'none' (disabled), 'console' (dev), 'otlp' (production)",
      "otlpEndpoint": null,
      "_comment_otlpEndpoint": "OTLP endpoint for log export (e.g., http://otel-collector:4317)",
      "otlpHeaders": null,
      "_comment_otlpHeaders": "Optional headers for OTLP authentication (e.g., 'x-api-key=your-key')"
    },
    "metrics": {
      "enabled": false,
      "_comment_enabled": "Metrics collection via Prometheus. Set to true in appsettings.Production.json",
      "endpoint": "/metrics",
      "_comment_endpoint": "HTTP endpoint for Prometheus scraping. Requires authentication (except in QuickStart mode)",
      "usePrometheus": true,
      "_comment_usePrometheus": "Export metrics in Prometheus text format"
    },
    "tracing": {
      "exporter": "none",
      "_comment_exporter": "Trace exporter type: 'none' (disabled), 'console' (dev), 'otlp' (production)",
      "samplingRatio": 1.0,
      "_comment_samplingRatio": "Sampling ratio for traces (0.0-1.0). Use 0.1 for 10% sampling in high-traffic environments",
      "otlpEndpoint": null,
      "_comment_otlpEndpoint": "OTLP endpoint for distributed tracing (e.g., http://jaeger:4317 or http://tempo:4317)",
      "otlpHeaders": null,
      "_comment_otlpHeaders": "Optional headers for OTLP authentication (e.g., 'x-api-key=your-key')",
      "_comment_production": "For production, set exporter to 'otlp' and configure otlpEndpoint in appsettings.Production.json"
    },
    "requestLogging": {
      "enabled": false,
      "_comment_enabled": "Enable detailed HTTP request/response logging. Enable in production for audit trails",
      "logHeaders": false,
      "_comment_logHeaders": "Include request/response headers in logs (may contain sensitive data)",
      "slowThresholdMs": 5000,
      "_comment_slowThresholdMs": "Log requests slower than this threshold (milliseconds)"
    }
  },
  "HealthChecks": {
    "Timeout": "00:00:30",
    "Period": "00:00:10",
    "EnableDetailedErrors": true,
    "EnableDatabaseCheck": true,
    "EnableCacheCheck": true,
    "EnableStorageCheck": true,
    "EnableUI": false,
    "UIPath": "/healthchecks-ui",
    "PublishToPrometheus": true,
    "_comment_PublishToPrometheus": "Export health check results as Prometheus metrics"
  },
  "TokenRevocation": {
    "CleanupInterval": "01:00:00",
    "_CleanupInterval_Comment": "How often to clean up expired revoked tokens from storage",
    "EnableAutoCleanup": true,
    "_EnableAutoCleanup_Comment": "Automatically clean up expired revoked tokens on a schedule",
    "FailClosedOnRedisError": true,
    "_FailClosedOnRedisError_Comment": "SECURITY CRITICAL: When true, rejects all tokens if Redis is unavailable (fail-safe). When false, allows tokens if Redis is down (fail-open, INSECURE for production). Production should ALWAYS use true.",
    "_Behavior_Comment": "Fail-Closed (true): If Redis is unavailable, all authentication attempts are DENIED until Redis is restored. This prevents revoked tokens from being accepted but may cause temporary service disruption.",
    "_Alternative_Comment": "Fail-Open (false - NOT RECOMMENDED): If Redis is unavailable, revoked tokens may be accepted. Only use for development/testing where availability is more important than security."
  },
  "QueryResultCache": {
    "_comment": "Query result caching with Redis + in-memory L2 cache for 10-100x performance improvement",
    "DefaultExpiration": "00:05:00",
    "LayerMetadataExpiration": "00:30:00",
    "TileExpiration": "24:00:00",
    "QueryResultExpiration": "00:01:00",
    "CrsTransformExpiration": "7.00:00:00",
    "EnableCompression": true,
    "CompressionThreshold": 1024,
    "UseDistributedCache": true,
    "RedisInstanceName": "Honua:"
  },
  "Redis": {
    "_comment": "Configure Redis connection string in appsettings.Development.json or appsettings.Production.json",
    "ConnectionString": "",
    "InstanceName": "Honua:",
    "Enabled": false
  },
  "CacheInvalidation": {
    "_comment": "Controls cache invalidation resilience and consistency strategies",
    "RetryCount": 3,
    "RetryDelayMs": 100,
    "MaxRetryDelayMs": 5000,
    "Strategy": "Strict",
    "_StrategyOptions": "Strict (fail on invalidation failure), Eventual (allow temporary stale data), ShortTTL (reduce stale window)",
    "HealthCheckSampleSize": 100,
    "MaxDriftPercentage": 1.0,
    "ShortTtl": "00:00:30",
    "EnableDetailedLogging": true,
    "EnableMetrics": true,
    "OperationTimeout": "00:00:10"
  },
  "Resilience": {
    "Hedging": {
      "Enabled": true,
      "MaxHedgedAttempts": 2,
      "DelayMilliseconds": 50,
      "TimeoutSeconds": 5
    },
    "CircuitBreaker": {
      "_comment": "Circuit breaker settings for preventing cascading failures",
      "Database": {
        "Enabled": true,
        "FailureRatio": 0.5,
        "MinimumThroughput": 10,
        "SamplingDuration": "00:00:30",
        "BreakDuration": "00:00:30"
      },
      "ExternalApi": {
        "Enabled": true,
        "FailureRatio": 0.5,
        "MinimumThroughput": 10,
        "SamplingDuration": "00:00:30",
        "BreakDuration": "00:01:00"
      },
      "Storage": {
        "Enabled": true,
        "FailureRatio": 0.5,
        "MinimumThroughput": 10,
        "SamplingDuration": "00:00:30",
        "BreakDuration": "00:00:30"
      }
    },
    "Bulkhead": {
      "_comment": "Bulkhead isolation patterns to prevent resource exhaustion and noisy neighbor problems",
      "DatabaseEnabled": true,
      "DatabaseMaxParallelization": 50,
      "DatabaseMaxQueuedActions": 100,
      "ExternalApiEnabled": true,
      "ExternalApiMaxParallelization": 10,
      "ExternalApiMaxQueuedActions": 20,
      "PerTenantEnabled": true,
      "PerTenantMaxParallelization": 10,
      "PerTenantMaxQueuedActions": 20,
      "MemoryCircuitBreakerEnabled": true,
      "MemoryThresholdBytes": 1073741824
    }
  },
  "AllowedHosts": "*",
  "_AllowedHosts_Comment": "SECURITY: Change this to your actual domain in Production (validated at startup). Example: 'localhost;*.yourdomain.com;yourdomain.com'",
  "GitOps": {
    "Enabled": false,
    "RepositoryPath": "/path/to/config-repo",
    "StateDirectory": "./data/gitops-state",
    "DryRun": false,
    "Watcher": {
      "Branch": "main",
      "Environment": "production",
      "PollIntervalSeconds": 30
    },
    "Credentials": {
      "Username": "",
      "Password": ""
    },
    "Notifications": {
      "Enabled": true,
      "Slack": {
        "Enabled": false,
        "WebhookUrl": "",
        "Channel": "#deployments",
        "BotName": "Honua GitOps",
        "BotIcon": ":rocket:",
        "TimeoutSeconds": 10
      },
      "Email": {
        "Enabled": false,
        "SmtpServer": "smtp.example.com",
        "SmtpPort": 587,
        "UseSsl": true,
        "SmtpUsername": "",
        "SmtpPassword": "",
        "FromAddress": "gitops@example.com",
        "FromName": "Honua GitOps",
        "ToAddresses": [
          "team@example.com"
        ],
        "PerEnvironment": {
          "production": [
            "production-team@example.com"
          ],
          "staging": [
            "dev-team@example.com"
          ]
        },
        "TimeoutSeconds": 30
      },
      "TemplatesDirectory": null,
      "Types": {
        "DeploymentCreated": true,
        "ApprovalRequired": true,
        "Approved": true,
        "Rejected": true,
        "DeploymentStarted": true,
        "DeploymentCompleted": true,
        "DeploymentFailed": true,
        "Rollback": true
      },
      "Retry": {
        "MaxRetries": 3,
        "InitialDelayMs": 1000,
        "MaxDelayMs": 10000,
        "UseExponentialBackoff": true
      }
    }
  },
  "GeoETL": {
    "_comment": "GeoETL workflow resilience and error handling configuration",
    "Retry": {
      "DefaultMaxAttempts": 3,
      "DefaultBackoff": "Exponential",
      "DefaultInitialDelaySeconds": 5,
      "DefaultMaxDelaySeconds": 300,
      "TransientErrorRetryAttempts": 5,
      "UseJitter": true,
      "JitterFactor": 0.2
    },
    "CircuitBreaker": {
      "Enabled": true,
      "FailureThreshold": 5,
      "TimeoutSeconds": 60
    },
    "DeadLetterQueue": {
      "Enabled": true,
      "RetentionDays": 30,
      "MaxRetries": 3,
      "AutoRetryTransientErrors": false
    }
  },
  "QueryTimeout": {
    "_comment": "Database query timeout configuration for different operation types. Prevents long-running queries from blocking resources.",
    "DefaultTimeout": "00:00:30",
    "_DefaultTimeout_comment": "Global default timeout for all operations (30 seconds)",
    "SimpleQueryTimeout": "00:00:15",
    "_SimpleQueryTimeout_comment": "Timeout for simple feature queries (15 seconds)",
    "StatisticsTimeout": "00:01:00",
    "_StatisticsTimeout_comment": "Timeout for statistics/aggregation queries (60 seconds)",
    "TileGenerationTimeout": "00:00:10",
    "_TileGenerationTimeout_comment": "Timeout for vector tile generation (10 seconds)",
    "ExtentCalculationTimeout": "00:00:30",
    "_ExtentCalculationTimeout_comment": "Timeout for bounding box calculations (30 seconds)",
    "CountTimeout": "00:00:30",
    "_CountTimeout_comment": "Timeout for count operations (30 seconds)",
    "DistinctTimeout": "00:00:30",
    "_DistinctTimeout_comment": "Timeout for distinct value queries (30 seconds)",
    "TimeoutWarningThreshold": 0.75,
    "_TimeoutWarningThreshold_comment": "Log warnings when queries exceed 75% of timeout",
    "EnableDetailedLogging": true,
    "_EnableDetailedLogging_comment": "Enable detailed logging for timeout events",
    "EnableMetrics": true,
    "_EnableMetrics_comment": "Enable metrics collection for query timeouts"
  },
  "honua": {
    "pagination": {
      "defaultLimit": 10,
      "maxLimit": 1000,
      "stacCollectionDefaultLimit": 10,
      "stacCollectionMaxLimit": 1000,
      "stacItemDefaultLimit": 10,
      "stacItemMaxLimit": 1000,
      "stacSearchDefaultLimit": 10,
      "stacSearchMaxLimit": 1000
    },
    "apiVersioning": {
      "defaultVersion": "v1",
      "allowLegacyUrls": true,
      "legacyRedirectVersion": "v1",
      "deprecationWarnings": {
        "_comment": "Add version and sunset date (ISO 8601 format) for deprecated versions",
        "_example": "v1: 2026-12-31T23:59:59Z"
      },
      "deprecationDocumentationUrl": "https://docs.honua.io/api/versioning#deprecation"
    },
    "authentication": {
      "mode": "Local",
      "enforce": true,
      "quickStart": {
        "enabled": false
      }
    },
    "odata": {
      "enabled": true,
      "allowWrites": false,
      "defaultPageSize": 100,
      "maxPageSize": 1000,
      "emitWktShadowProperties": true
    },
    "zarr": {
      "timeSeries": {
        "enableCaching": true,
        "cacheDuration": "00:15:00",
        "maxSlicesPerRequest": 100,
        "enableAggregation": true,
        "chunkCacheSize": 1000,
        "timeStepCacheDuration": "01:00:00"
      }
    },
    "vectorTilePreseed": {
      "maxTilesPerJob": 100000,
      "maxConcurrentJobs": 5,
      "maxJobsPerUser": 3,
      "jobTimeout": "1.00:00:00",
      "maxZoomLevel": 18,
      "rateLimitWindow": "00:00:10"
    },
    "services": {
      "geoservicesREST": {
        "enabled": true,
        "defaultMaxRecordCount": 1000,
        "maxRecordCount": 10000,
        "defaultFormat": "json",
        "enableTelemetry": true
      }
    }
  }
}
