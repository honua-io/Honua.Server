{
  "Webhook": {
    "Security": {
      // IMPORTANT: Signature validation is enabled by default for security
      // Set to false only during migration or development
      "RequireSignature": true,

      // Header name for the webhook signature
      // Common values:
      // - "X-Hub-Signature-256" (GitHub-style, default)
      // - "X-Signature" (generic)
      // - "X-Webhook-Signature" (custom)
      "SignatureHeaderName": "X-Hub-Signature-256",

      // SECURITY WARNING: Never commit secrets to source control!
      // Use environment variable instead:
      // Webhook__Security__SharedSecret=your-secret
      //
      // Generate a secure secret (minimum 64 characters recommended):
      // openssl rand -base64 64
      //
      // For production, use Azure Key Vault, AWS Secrets Manager, or similar
      "SharedSecret": null,

      // Additional secrets for secret rotation
      // During rotation:
      // 1. Add new secret to this array
      // 2. Update webhook senders to use new secret
      // 3. Remove old secret from SharedSecret or this array
      "AdditionalSecrets": [],

      // Maximum payload size in bytes (default: 1 MB)
      // Prevents DoS attacks via large payloads
      "MaxPayloadSize": 1048576,

      // Allow HTTP connections (default: false)
      // SECURITY: Should only be true in development
      // Production should always use HTTPS
      "AllowInsecureHttp": false,

      // Maximum webhook age in seconds (default: 300 = 5 minutes)
      // Prevents replay attacks
      // Set to 0 to disable timestamp validation
      "MaxWebhookAge": 300,

      // Header name for webhook timestamp
      // Expected format: Unix timestamp (seconds since epoch) or ISO 8601
      "TimestampHeaderName": "X-Webhook-Timestamp"
    }
  },

  // Example: Full configuration with webhook security
  "ConnectionStrings": {
    "AlertHistory": "Host=localhost;Database=alerts;Username=alerts_user;Password=${DB_PASSWORD}"
  },

  "Authentication": {
    // SECURITY: JWT signing key must be at least 64 characters (512 bits)
    // NIST SP 800-107 recommends key length >= hash output
    // Generate: openssl rand -base64 64
    // Store in environment variable or secrets manager (Azure Key Vault, AWS Secrets Manager)
    "JwtSecret": "${JWT_SECRET}",
    "JwtIssuer": "honua-alert-receiver",
    "JwtAudience": "honua-alert-api",

    // RECOMMENDED: Use JwtSigningKeys for key rotation support
    // See appsettings.json for detailed rotation instructions
    "JwtSigningKeys": [
      {
        "keyId": "key-2024-01",
        "key": "${JWT_SIGNING_KEY_CURRENT}",  // >= 64 characters
        "active": true
      },
      {
        "keyId": "key-2023-12",
        "key": "${JWT_SIGNING_KEY_PREVIOUS}",  // >= 64 characters
        "active": false  // Keep previous key during rotation period
      }
    ]
  },

  "Alerts": {
    "SNS": {
      "CriticalTopicArn": "arn:aws:sns:us-east-1:123456789:critical-alerts",
      "DefaultTopicArn": "arn:aws:sns:us-east-1:123456789:default-alerts"
    },
    "Slack": {
      "CriticalWebhookUrl": "${SLACK_CRITICAL_WEBHOOK}",
      "DefaultWebhookUrl": "${SLACK_DEFAULT_WEBHOOK}"
    }
  },

  "Serilog": {
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "System": "Warning"
      }
    }
  }
}
