{
  "id": "difference-analysis",
  "name": "Difference Analysis",
  "description": "Calculate geometric difference (A minus B). Returns areas from first layer that don't overlap with second layer.",
  "category": "Overlay Operations",
  "icon": "subtract",
  "difficulty": 1,
  "estimatedMinutes": 3,
  "tags": ["difference", "subtract", "overlay", "exclusion"],
  "author": "HonuaIO",
  "version": "1.0",
  "inputRequirements": [
    "Two polygon layers"
  ],
  "expectedOutputs": [
    "Non-overlapping areas from first layer"
  ],
  "useCases": [
    "Finding areas outside protected zones",
    "Calculating developable land after exclusions",
    "Identifying gaps in coverage"
  ],
  "nodes": [
    {
      "id": "source_1",
      "type": "postgis_source",
      "name": "Load Base Layer",
      "description": "Layer to subtract from",
      "parameters": {
        "connectionString": "Host=localhost;Database=gis;Username=gis;Password=gis",
        "tableName": "base_layer",
        "schemaName": "public"
      },
      "position": {
        "x": 100,
        "y": 80
      }
    },
    {
      "id": "source_2",
      "type": "postgis_source",
      "name": "Load Subtract Layer",
      "description": "Layer to subtract",
      "parameters": {
        "connectionString": "Host=localhost;Database=gis;Username=gis;Password=gis",
        "tableName": "subtract_layer",
        "schemaName": "public"
      },
      "position": {
        "x": 100,
        "y": 180
      }
    },
    {
      "id": "geo_1",
      "type": "difference",
      "name": "Calculate Difference",
      "description": "Subtract second from first",
      "parameters": {
        "preserveAttributes": true
      },
      "position": {
        "x": 350,
        "y": 130
      }
    },
    {
      "id": "sink_1",
      "type": "postgis_sink",
      "name": "Save Results",
      "description": "Store difference results",
      "parameters": {
        "connectionString": "Host=localhost;Database=gis;Username=gis;Password=gis",
        "tableName": "difference_result",
        "schemaName": "public",
        "srid": 4326,
        "createTable": true
      },
      "position": {
        "x": 550,
        "y": 130
      }
    }
  ],
  "edges": [
    {
      "from": "source_1",
      "to": "geo_1",
      "toPort": "input_a"
    },
    {
      "from": "source_2",
      "to": "geo_1",
      "toPort": "input_b"
    },
    {
      "from": "geo_1",
      "to": "sink_1"
    }
  ],
  "parameters": {
    "baseLayer": {
      "name": "baseLayer",
      "type": "string",
      "description": "Base layer table",
      "defaultValue": "base_layer",
      "required": true
    },
    "subtractLayer": {
      "name": "subtractLayer",
      "type": "string",
      "description": "Layer to subtract",
      "defaultValue": "subtract_layer",
      "required": true
    },
    "outputTable": {
      "name": "outputTable",
      "type": "string",
      "description": "Output difference table",
      "defaultValue": "difference_result",
      "required": true
    }
  }
}
